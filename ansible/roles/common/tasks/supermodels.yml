---

- name: Clean supermodels-test path
  file:
    state: absent
    path: /opt/app/supermodels-test

- name: Fetch supermodels-test from github
  git:
    repo: "https://{{ waiwera_user }}:{{ waiwera_pwd }}@github.com/johnburnell/supermodels-test.git"
    dest: /opt/app/supermodels-test
    version: testing

- name: replace HOME with app directory
  replace:
    dest: /opt/app/supermodels-test/makefile
    regexp: '\$\(HOME\)'
    replace: '/opt/app'

- name: Make the supermodels-test
  shell: make
  args:
    chdir: /opt/app/supermodels-test

- name: Set file permissions supermodels
  file:
    dest: /opt/app/supermodels-test
    owner: root
    group: root
    mode: u=rwX,g=rwX,o=rwX
    recurse: yes
